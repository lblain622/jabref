


<!DOCTYPE html>
<html id="htmlId">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"> 
  <title>Coverage Report > RangeOverlapWithin</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">org.jabref.model.openoffice.rangesort</a>
</div>

<h1>Coverage Summary for Class: RangeOverlapWithin (org.jabref.model.openoffice.rangesort)</h1>

<table class="coverageStats">
<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Class, %
</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Branch, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">RangeOverlapWithin</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/30)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/38)
  </span>
</td>
</tr>

</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;package org.jabref.model.openoffice.rangesort;
&nbsp;
&nbsp;import java.util.ArrayList;
&nbsp;import java.util.List;
&nbsp;
&nbsp;import org.jabref.model.openoffice.uno.UnoCast;
&nbsp;import org.jabref.model.openoffice.uno.UnoTextRange;
&nbsp;
&nbsp;import com.sun.star.text.XTextDocument;
&nbsp;import com.sun.star.text.XTextRange;
&nbsp;import com.sun.star.text.XTextRangeCompare;
&nbsp;
<b class="nc">&nbsp;public class RangeOverlapWithin {</b>
&nbsp;
&nbsp;    private RangeOverlapWithin() {
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Report identical, overlapping or touching ranges between elements of rangeHolders.
&nbsp;     * &lt;p&gt;
&nbsp;     * For overlapping and touching, only report consecutive ranges and only with a single sample of otherwise identical ranges.
&nbsp;     *
&nbsp;     * @param rangeHolders    represent the ranges to be checked.
&nbsp;     *                        &lt;p&gt;
&nbsp;     *                        Note: for each rangeHolder, rangeHolder.getRange() is called multiple times. To avoid repeated work, they should keep a copy of the range instead of getting it each time from the document.
&nbsp;     * @param reportAtMost    Limit the number of records returned to atMost. Zero {@code reportAtMost} means no limit.
&nbsp;     * @param includeTouching Should the result contain ranges sharing only a boundary?
&nbsp;     */
&nbsp;    public static &lt;V extends RangeHolder&gt;
&nbsp;    List&lt;RangeOverlap&lt;V&gt;&gt; findOverlappingRanges(XTextDocument doc,
&nbsp;                                                List&lt;V&gt; rangeHolders,
&nbsp;                                                boolean includeTouching,
&nbsp;                                                int reportAtMost) {
&nbsp;
<b class="nc">&nbsp;        RangeSort.RangePartitions&lt;V&gt; partitions = RangeSort.partitionAndSortRanges(rangeHolders);</b>
&nbsp;
<b class="nc">&nbsp;        return findOverlappingRanges(partitions, reportAtMost, includeTouching);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Report identical, overlapping or touching ranges.
&nbsp;     * &lt;p&gt;
&nbsp;     * For overlapping and touching, only report consecutive ranges and only with a single sample of otherwise identical ranges.
&nbsp;     *
&nbsp;     * @param atMost          Limit the number of records returned to atMost. Zero {@code atMost} means no limit.
&nbsp;     * @param includeTouching Should the result contain ranges sharing only a boundary?
&nbsp;     */
&nbsp;    public static &lt;V extends RangeHolder&gt;
&nbsp;    List&lt;RangeOverlap&lt;V&gt;&gt; findOverlappingRanges(RangeSort.RangePartitions&lt;V&gt; input,
&nbsp;                                                int atMost,
&nbsp;                                                boolean includeTouching) {
<b class="nc">&nbsp;        assert atMost &gt;= 0;</b>
&nbsp;
<b class="nc">&nbsp;        List&lt;RangeOverlap&lt;V&gt;&gt; result = new ArrayList&lt;&gt;();</b>
&nbsp;
<b class="nc">&nbsp;        for (List&lt;V&gt; partition : input.getPartitions()) {</b>
<b class="nc">&nbsp;            if (partition.isEmpty()) {</b>
&nbsp;                continue;
&nbsp;            }
<b class="nc">&nbsp;            XTextRangeCompare cmp = UnoCast.cast(XTextRangeCompare.class,</b>
<b class="nc">&nbsp;                    partition.getFirst().getRange().getText()).get();</b>
&nbsp;
<b class="nc">&nbsp;            for (int i = 0; i &lt; (partition.size() - 1); i++) {</b>
<b class="nc">&nbsp;                V aHolder = partition.get(i);</b>
<b class="nc">&nbsp;                V bHolder = partition.get(i + 1);</b>
<b class="nc">&nbsp;                XTextRange aRange = aHolder.getRange();</b>
<b class="nc">&nbsp;                XTextRange bRange = bHolder.getRange();</b>
&nbsp;
&nbsp;                // check equal values
<b class="nc">&nbsp;                int cmpResult = UnoTextRange.compareStartsThenEndsUnsafe(cmp, aRange, bRange);</b>
<b class="nc">&nbsp;                if (cmpResult == 0) {</b>
<b class="nc">&nbsp;                    List&lt;V&gt; aValues = new ArrayList&lt;&gt;();</b>
<b class="nc">&nbsp;                    aValues.add(aHolder);</b>
&nbsp;                    // aValues.add(bHolder);
&nbsp;                    // collect those equal
<b class="nc">&nbsp;                    while (i &lt; (partition.size() - 1) &amp;&amp;</b>
<b class="nc">&nbsp;                            UnoTextRange.compareStartsThenEndsUnsafe(</b>
&nbsp;                                    cmp,
&nbsp;                                    aRange,
<b class="nc">&nbsp;                                    partition.get(i + 1).getRange()) == 0) {</b>
<b class="nc">&nbsp;                        bHolder = partition.get(i + 1);</b>
<b class="nc">&nbsp;                        aValues.add(bHolder);</b>
<b class="nc">&nbsp;                        i++;</b>
&nbsp;                    }
<b class="nc">&nbsp;                    result.add(new RangeOverlap&lt;&gt;(RangeOverlapKind.EQUAL_RANGE, aValues));</b>
<b class="nc">&nbsp;                    if (atMost &gt; 0 &amp;&amp; result.size() &gt;= atMost) {</b>
<b class="nc">&nbsp;                        return result;</b>
&nbsp;                    }
&nbsp;                    continue;
&nbsp;                }
&nbsp;
&nbsp;                // Not equal, and (a &lt;= b) since sorted.
&nbsp;                // Check if a.end &gt;= b.start
<b class="nc">&nbsp;                cmpResult = UnoTextRange.compareStartsUnsafe(cmp, aRange.getEnd(), bRange.getStart());</b>
<b class="nc">&nbsp;                if (cmpResult &gt; 0 || (includeTouching &amp;&amp; (cmpResult == 0))) {</b>
&nbsp;                    // found overlap or touch
<b class="nc">&nbsp;                    List&lt;V&gt; valuesForOverlappingRanges = new ArrayList&lt;&gt;();</b>
<b class="nc">&nbsp;                    valuesForOverlappingRanges.add(aHolder);</b>
<b class="nc">&nbsp;                    valuesForOverlappingRanges.add(bHolder);</b>
<b class="nc">&nbsp;                    result.add(new RangeOverlap&lt;&gt;(cmpResult == 0</b>
<b class="nc">&nbsp;                                                  ? RangeOverlapKind.TOUCH</b>
<b class="nc">&nbsp;                                                  : RangeOverlapKind.OVERLAP,</b>
&nbsp;                            valuesForOverlappingRanges));
&nbsp;                }
<b class="nc">&nbsp;                if (atMost &gt; 0 &amp;&amp; result.size() &gt;= atMost) {</b>
<b class="nc">&nbsp;                    return result;</b>
&nbsp;                }
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        return result;</b>
&nbsp;    }
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2025-09-29 22:51</div>
</div>
</body>
</html>
